#!/bin/sh
# Enforce Conventional Commits (lightweight local guardrail).
#
# Format: <type>(<scope>): <subject>
# Example: feat(worldgen): validate datapack registries

COMMIT_MSG_FILE="$1"
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

PATTERN='^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-z0-9_.-]+\))?: .+'

if ! printf "%s" "$COMMIT_MSG" | grep -Eq "$PATTERN"; then
  echo "Invalid commit message. Use Conventional Commits." >&2
  echo "Example: feat(worldgen): add registry key constants" >&2
  exit 1
fi
